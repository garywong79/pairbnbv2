!function(){var e,t,n,i,r,o,a,s,l,u,c=Object.prototype.hasOwnProperty,d=function(e,t){return function(){return e.apply(t,arguments)}};l=this,n=l.document,a=l.location,i=function(e){function t(e){for(p=1;e=r.shift();)e()}var i,r=[],o=!1,a=n,s=a.documentElement,l=s.doScroll,u="DOMContentLoaded",c="addEventListener",d="onreadystatechange",h="readyState",p=/^loade|c/.test(a[h]);return a[c]&&a[c](u,i=function(){a.removeEventListener(u,i,o),t()},o),l&&a.attachEvent(d,i=function(){/^c/.test(a[h])&&(a.detachEvent(d,i),t())}),e=l?function(t){self!=top?p?t():r.push(t):function(){try{s.doScroll("left")}catch(n){return setTimeout(function(){e(t)},50)}t()}()}:function(e){p?e():r.push(e)}}(),r=l.encodeURIComponent,t=l.decodeURIComponent,s={getElementsByClassName:function(e){var t,i,r,o,a,s;if(n.getElementsByClassName)return n.getElementsByClassName(e);if(n.querySelectorAll)return n.querySelectorAll("."+e);for(r=RegExp("(?:^|\\s)"+e+"(?:\\s|$)","i"),i=n.getElementsByTagName("*"),s=[],o=0,a=i.length;a>o;o++)t=i[o],r.test(t.className)&&s.push(t);return s},parseQueryString:function(e){var n,i,r,o,a,s,l,u;if(null==e&&(e=""),r={},!e)return r;for(0===e.indexOf("?")&&(e=e.slice(1)),l=e.split("&"),a=0,s=l.length;s>a;a++)i=l[a],u=i.split("="),n=u[0],o=u[1],"undefined"==typeof o&&(o=""),r[t(n)]=t(o)||null;return r},toQueryString:function(e,t){var n,i,o;i=[];for(n in e)c.call(e,n)&&(o=e[n],o||o===!1||0===o?i.push(""+r(n)+"="+r(o)):t||i.push(r(n)));return i.join("&")},addEventListener:function(e,t,n){return"function"==typeof e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):void 0},getElementOffset:function(e){var t,i,r;return e.getBoundingClientRect?(t=e.getBoundingClientRect(),i=l.scrollX||n.documentElement.scrollLeft,r=l.scrollY||n.documentElement.scrollTop,{top:Math.floor(t.top+r),left:Math.floor(t.left+i)}):{top:0,left:0}},containsElement:function(e,t){if(t===e)return!0;for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},bindHover:function(e,t,n){return s.addEventListener(e,"mouseover",function(n){var i;return n||(n=l.event),i=n.relatedTarget||n.fromElement,i&&s.containsElement(e,i)?void 0:t.apply(this,arguments)}),s.addEventListener(e,"mouseout",function(t){var i;return t||(t=l.event),i=t.relatedTarget||t.toElement,i&&!s.containsElement(e,i)?n.apply(this,arguments):void 0})},documentReady:i,getOrigin:function(e){return e.split("/").slice(0,3).join("/")}},e=function(){function e(e){null==e&&(e={}),this._onResize=d(this._onResize,this),this._onMouseLeave=d(this._onMouseLeave,this),this._onMouseEnter=d(this._onMouseEnter,this),this._onMessage=d(this._onMessage,this),this._onReady=d(this._onReady,this),this._processMessage=d(this._processMessage,this),this.postWindowDimensions=d(this.postWindowDimensions,this),this.hidePopover=d(this.hidePopover,this),this.showPopover=d(this.showPopover,this),this.build=d(this.build,this),this.setup=d(this.setup,this),this.baseHostname=e.baseHostname,this.baseLocation=e.baseLocation,this.assets=e.assets,this.iframes=[]}return e.utils=s,e.prototype.iframes=null,e.prototype.element=null,e.prototype.hasSetupRun=!1,e.prototype.isUserLoggedIn=!1,e.prototype.isPopoverVisible=!1,e.prototype.isQuirksMode=function(){return"CSS1Compat"!==n.compatMode},e.prototype.setup=function(){return this.hasSetupRun||this.isQuirksMode()?void 0:(this.hasSetupRun=!0,this.setupMessaging(),this.setupResize(),this.createStyle())},e.prototype.build=function(){var e,t,n,i,r;for(this.setup(),t=s.getElementsByClassName("send-to-readmill"),r=[],n=0,i=t.length;i>n;n++)e=t[n],"iframe"!==e.tagName.toLowerCase()&&r.push(this.processMarker(e));return r},e.prototype.processMarker=function(e){var t,n,i,r,o;return i=e.parentNode,o=this.baseLocation,n=this.extractParams(e,l.location),r=-1===o.indexOf("?")?"?":"&",o+=r+s.toQueryString(n,!0),t=this.createIframe(o,n.display),i.insertBefore(t,e),i.removeChild(e),this.iframes.push(this.createPromise(t))},e.prototype.extractParams=function(e,t){var n,i,r,o,a,s,l;for(r={},l=["data-download-url","data-buy-url","data-origin-domain"],a=0,s=l.length;s>a;a++)n=l[a],i=n.slice(5).replace(/-/g,"_"),o=e.getAttribute(n),null!=o&&o!==n&&(r[i]=o);return r.display=this.getDisplayClass(e),r.parent_domain=""+t.protocol+"//"+t.host,this.isCurrentHostname(t.hostname)&&r.origin_domain||(r.origin_domain=t.hostname),r},e.prototype.isCurrentHostname=function(e){var t;return t=(e||"").indexOf(this.baseHostname),t>-1&&t===e.length-this.baseHostname.length},e.prototype.setupResize=function(){return s.addEventListener(l,"resize",this._onResize)},e.prototype.setupMessaging=function(){return s.addEventListener(l,"message",this._onMessage)},e.prototype.getFrameForWindow=function(e){var t,n,i,r;for(r=this.iframes,n=0,i=r.length;i>n;n++)if(t=r[n],t.iframe.contentWindow===e)return t.iframe;return null},e.prototype.getDisplayClass=function(e){var t;return t=(e.getAttribute("data-display")||"").toLowerCase(),"small"===t?"small":"large"},e.prototype.showPopover=function(e){var t,i,r,o,a,u,c,d,h,p,f,m,g,v,y,b,w,x,k,T;return v=this.element.firstChild.offsetWidth,u=this.element.firstChild.offsetHeight,T=l.innerWidth||n.documentElement.offsetWidth,y=l.innerHeight||n.documentElement.offsetHeight,k=l.scrollY||n.documentElement.scrollTop,x=l.scrollX||n.documentElement.scrollLeft,c=s.getElementOffset(e),h=c.top-k,d=c.left-x,m=.5*(v-e.offsetWidth),b=c.left,w=T-(c.left+e.offsetWidth),i=b>m&&w>m,t=y-(h+e.offsetHeight)>=u,o=T-(c.left+e.offsetWidth+v)>0,r=c.left>v,a=c.top-u>=0,(p=t&&i?"bottom":o?"right":a&&i?"top":r?"left":"")?(g=e.getAttribute("data-str-size"),this.element.className=this.element.className.replace(/[ ]?send-to-readmill-(?:top|right|left|bottom|small|large)/g,""),this.element.className+=" send-to-readmill-"+p+" send-to-readmill-"+g,this.element.style.top=Math.floor(c.top+.5*e.offsetHeight)+"px",this.element.style.left=Math.floor(c.left+.5*e.offsetWidth)+"px",f="top"===p||"bottom"===p?Math.floor(v*-.5)+"px":"",this.element.firstChild.style.marginLeft=f,this.isPopoverVisible=!0):void 0},e.prototype.startShowPopover=function(e){var t=this;return this.cancelHidePopover(),this._showTimer=setTimeout(function(){return t.showPopover(e)},100)},e.prototype.cancelShowPopover=function(){return clearTimeout(this._showTimer),delete this._showTimer},e.prototype.hidePopover=function(){return this.element.style.top="",this.element.style.left=""},e.prototype.startHidePopover=function(){return this.cancelShowPopover(),this._hideTimer=setTimeout(this.hidePopover,300)},e.prototype.cancelHidePopover=function(){return clearTimeout(this._hideTimer),delete this._hideTimer},e.prototype.createStyle=function(){var e,t;return t=n.createElement("style"),t.type="text/css",e='  .send-to-readmill-popup-wrapper {\nposition: absolute;\ntop: -999999px;\nleft: -999999px;\nwidth: 0;\nheight: 0;\nz-index: 100000000;\n}\n\n.send-to-readmill-popup {\nposition: absolute;\nbackground: #fff;\nborder: #eee solid 2px;\nfont: 14px/30px Georgia, Garamond, serif;\ntext-align: center;\ncolor: #000;\npadding: 10px;\n-webkit-box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n-moz-box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n-ms-box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\n-o-box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\nbox-shadow: 0 0 10px rgba(0, 0, 0, 0.15);\nwhite-space: nowrap;\n}\n.send-to-readmill-logged-in .send-to-readmill-popup {\npadding-left: 47px; /* For avatar */\ntext-align: left;\n}\n\n/* Fake anchors to prevent style bleed */\n.send-to-readmill-link {\ncolor: #58852c;\ntext-decoration: none;\ncursor: pointer;\n}\n.send-to-readmill-link:hover,\n.send-to-readmill-link:focus {\ncolor: #4F9C02;\ntext-decoration: underline;\noutline: none;\n}\n\n.send-to-readmill-avatar {\nposition: absolute;\ntop: 10px;\nleft: 10px;\ndisplay: block;\nwidth: 30px;\nheight: 30px;\nvertical-align: -5px;\nbackground-position: 0 0;\nbackground-repeat: no-repeat;\nbackground-size: 100% auto;\n}\n.send-to-readmill-avatar:hover {\ntext-decoration: none;\n}\n\n/* Position large */\n\n.send-to-readmill-top .send-to-readmill-popup {\ntop: -115px;\n}\n\n.send-to-readmill-bottom .send-to-readmill-popup {\ntop: 33px;\n}\n\n.send-to-readmill-left .send-to-readmill-popup {\ntop: -41px;\nright: 98px;\n}\n\n.send-to-readmill-right .send-to-readmill-popup {\ntop: -41px;\nleft: 98px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-top .send-to-readmill-popup {\ntop: -85px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-left .send-to-readmill-popup {\ntop: -26px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-right .send-to-readmill-popup {\ntop: -26px;\n}\n\n/* Position small */\n\n.send-to-readmill-bottom.send-to-readmill-small .send-to-readmill-popup {\ntop: 26px;\n}\n\n.send-to-readmill-top.send-to-readmill-small .send-to-readmill-popup {\ntop: -108px;\n}\n\n.send-to-readmill-left.send-to-readmill-small .send-to-readmill-popup {\ntop: -41px;\nright: 50px;\n}\n\n.send-to-readmill-right.send-to-readmill-small .send-to-readmill-popup {\ntop: -41px;\nleft: 50px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-top.send-to-readmill-small .send-to-readmill-popup {\ntop: -78px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-left.send-to-readmill-small .send-to-readmill-popup {\ntop: -26px;\n}\n\n.send-to-readmill-logged-in.send-to-readmill-right.send-to-readmill-small .send-to-readmill-popup {\ntop: -26px;\n}\n\n/* Arrows */\n\n.send-to-readmill-right .send-to-readmill-popup {\nbackground: #fff;\nborder: 1px solid #d9d9d9;\n}\n.send-to-readmill-right .send-to-readmill-popup::after, .send-to-readmill-right .send-to-readmill-popup::before {\nright: 100%;\nborder: solid transparent;\ncontent: " ";\nheight: 0;\nwidth: 0;\nposition: absolute;\npointer-events: none;\nz-index: 10000;\n}\n.send-to-readmill-right .send-to-readmill-popup::after {\nborder-right-color: #fff;\nborder-width: 4px;\ntop: 50%;\nmargin-top: -4px;\n}\n.send-to-readmill-right .send-to-readmill-popup::before {\nborder-right-color: #c9c9c9; /* use darker grey than #d9d9d9 to compensate for lack of dropshadow */\nborder-width: 5px;\ntop: 50%;\nmargin-top: -5px;\n}\n.send-to-readmill-top .send-to-readmill-popup {\nbackground: #fff;\nborder: 1px solid #d9d9d9;\n}\n.send-to-readmill-top .send-to-readmill-popup::after, .send-to-readmill-top .send-to-readmill-popup::before {\ntop: 100%;\nborder: solid transparent;\ncontent: " ";\nheight: 0;\nwidth: 0;\nposition: absolute;\npointer-events: none;\n}\n.send-to-readmill-top .send-to-readmill-popup::after {\nborder-top-color: #fff;\nborder-width: 4px;\nleft: 50%;\nmargin-left: -4px;\n}\n.send-to-readmill-top .send-to-readmill-popup::before {\nborder-top-color: #c9c9c9;\nborder-width: 5px;\nleft: 50%;\nmargin-left: -5px;\n}\n.send-to-readmill-left .send-to-readmill-popup {\nbackground: #fff;\nborder: 1px solid #d9d9d9;\n}\n.send-to-readmill-left .send-to-readmill-popup::after, .send-to-readmill-left .send-to-readmill-popup::before {\nleft: 100%;\nborder: solid transparent;\ncontent: " ";\nheight: 0;\nwidth: 0;\nposition: absolute;\npointer-events: none;\n}\n.send-to-readmill-left .send-to-readmill-popup::after {\nborder-left-color: #fff;\nborder-width: 4px;\ntop: 50%;\nmargin-top: -4px;\n}\n.send-to-readmill-left .send-to-readmill-popup::before {\nborder-left-color: #c9c9c9;\nborder-width: 5px;\ntop: 50%;\nmargin-top: -5px;\n}\n.send-to-readmill-bottom .send-to-readmill-popup {\nbackground: #fff;\nborder: 1px solid #d9d9d9;\n}\n.send-to-readmill-bottom .send-to-readmill-popup::after, .send-to-readmill-bottom .send-to-readmill-popup::before {\nbottom: 100%;\nborder: solid transparent;\ncontent: " ";\nheight: 0;\nwidth: 0;\nposition: absolute;\npointer-events: none;\n}\n.send-to-readmill-bottom .send-to-readmill-popup::after {\nborder-bottom-color: #fff;\nborder-width: 4px;\nleft: 50%;\nmargin-left: -4px;\n}\n.send-to-readmill-bottom .send-to-readmill-popup::before {\nborder-bottom-color: #c9c9c9;\nborder-width: 5px;\nleft: 50%;\nmargin-left: -5px;\n}\n',"undefined"!=typeof t.textContent?t.textContent=e:t.styleSheet.cssText=e,n.getElementsByTagName("head")[0].appendChild(t)},e.prototype.createIframe=function(e,t){var i,r,o,a,s,u,d,h,p;o=n.createElement("iframe"),o.src=e,a=l.devicePixelRatio&&l.devicePixelRatio>=1.5,h={top:0,left:0,width:"170px",height:"40px",margin:0,border:"none",position:"static","background-size":"100% auto","background-color":"transparent","background-repeat":"no-repeat","background-position":"0 0"},i=a?this.assets.large2x:this.assets.large,"small"===t&&(h.width="72px",h.height="26px",i=a?this.assets.small2x:this.assets.small),h["background-image"]="url("+i+")",r=function(){var e;e=[];for(s in h)c.call(h,s)&&(p=h[s],e.push(""+s+":"+p+"!important;"));return e}(),o.style.cssText=r.join(""),u={tabIndex:0,scrolling:"no",frameBorder:"0",allowTransparency:!0},o.setAttribute("data-str-size",t);for(d in u)c.call(u,d)&&(p=u[d],o[d]=p);return o.className="send-to-readmill",o},e.prototype.createPromise=function(e){var t;return t={queue:[],iframe:e,loaded:!1,call:function(e){var t=this;return setTimeout(function(){return e(t.iframe)},0)},done:function(e){return this.loaded?this.call(e):this.queue.push(e)},dequeue:function(){var e,t;if(this.loaded){for(t=[];e=this.queue.pop();)t.push(e(this.iframe));return t}}},e.onload=function(){return e.onload=null,t.loaded=!0,t.dequeue()},t},e.prototype.createPopover=function(e){var t,i;return null==e&&(e={}),t=n.createElement("div"),t.innerHTML=this.createPopoverTemplate(e),i=t.firstChild,s.bindHover(i.firstChild,this._onMouseEnter,this._onMouseLeave),s.addEventListener(i,"click",function(e){var t,n;return e||(e=l.event),n=e.target||e.srcElement,t=n.getAttribute("data-str-href"),t?l.open(t,"_blank"):void 0}),i},e.prototype.createPopoverTemplate=function(e){var t,n,i,r,o,a,s,l,u,c;return n=e.fullname,s=e.profileUrl,t=e.avatarUrl,i=e.learnMoreUrl,l=e.readmillUrl,u="large",a="bottom",r="0px",c=n&&n.length?(o="s"===n.slice(-1).toLowerCase()?"":"s",'<div class="send-to-readmill-popup-wrapper send-to-readmill-logged-in send-to-readmill-'+a+" send-to-readmill-"+u+'">\n<div class="send-to-readmill-popup" style="margin-left: '+r+'">\n  <span class="send-to-readmill-link send-to-readmill-avatar" data-str-href="'+s+'" style="background-image: url('+t+')"></span>\n  Send to <span class="send-to-readmill-link" tabindex="0" data-str-href="'+s+'">'+n+"&rsquo;"+o+'</span> Library &middot;\n  <span class="send-to-readmill-link" tabindex="0" data-str-href="'+i+'">What is this?</span>\n</div>\n</div>'):'<div class="send-to-readmill-popup-wrapper send-to-readmill-'+a+" send-to-readmill-"+u+'">\n<div class="send-to-readmill-popup" style="margin-left: '+r+'">\n  Readmill is a unique ebook reader that lets you read, <br />share and discover great books &middot; <span class="send-to-readmill-link" tabindex="0" data-str-href="'+l+'">Learn more</span>\n</div>\n</div>',c.replace(/\n/g,"")},e.prototype.postWindowDimensions=function(){var e,t;return t=l.outerWidth||n.documentElement.offsetWidth,e=l.outerHeight||n.documentElement.offsetHeight,this.postMessage({type:"window",content:{width:t,height:e}})},e.prototype.postMessage=function(e){var t,n,i,r,o,a,l,u;for(null==e&&(e={}),e.content=s.toQueryString(e.content),t=s.toQueryString(e),i=s.getOrigin(this.baseLocation),n=function(e){var n;return n=e.contentWindow,n&&n.postMessage?n.postMessage(t,i):void 0},l=this.iframes,u=[],o=0,a=l.length;a>o;o++)r=l[o],u.push(r.done(n));return u},e.prototype._processMessage=function(e,t){switch(e.type){case"ready":return this._onReady(e);case"mouseout":case"mouseover":return"mouseout"===e.type?this.startHidePopover():this.startShowPopover(t)}},e.prototype._onReady=function(e){var t;return t=s.parseQueryString(e.content),this.element&&this.isUserLoggedIn!==t.loggedIn&&(this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null),this.element||(this.element=this.createPopover(t),this.element&&n.body.appendChild(this.element),this.postWindowDimensions()),this.isUserLoggedIn=e.content.loggedIn},e.prototype._onMessage=function(e){var t,n;if(e.origin===s.getOrigin(this.baseLocation)&&(t=this.getFrameForWindow(e.source)))return n=s.parseQueryString(e.data),this._processMessage(n,t)},e.prototype._onMouseEnter=function(){return this.cancelHidePopover()},e.prototype._onMouseLeave=function(){return this.startHidePopover()},e.prototype._onResize=function(){return this.isPopoverVisible&&this.hidePopover(),clearTimeout(this._resizing),this._resizing=setTimeout(this.postWindowDimensions,200)},e}(),l.Readmill||(l.Readmill={}),o=new e({baseHostname:"readmill.com",baseLocation:"https://widgets.readmill.com/send",assets:{small:"//d15fum6h02z48v.cloudfront.net/assets/widgets/btn_str_small-18d2d0ac017ff07a400d15d4981c447f.png",large:"//d15fum6h02z48v.cloudfront.net/assets/widgets/btn_str_large-35e7374f45d7688fd7982172029eac7c.png",small2x:"//d15fum6h02z48v.cloudfront.net/assets/widgets/btn_str_small@2x-f6ff1305d1d12d7bc16f528fe2713182.png",large2x:"//d15fum6h02z48v.cloudfront.net/assets/widgets/btn_str_large@2x-5b6b6661aa8a3372cd54836bb8c84314.png"}}),u=function(){return s.documentReady(o.build)},l.Readmill.SendToReadmill={build:o.build},u()}.call(this);